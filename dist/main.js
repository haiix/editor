(()=>{"use strict";var e,t,n,i={1804:(e,t,n)=>{n.d(t,{Z:()=>d});class i{constructor(){this.init("")}init(e){this.src=e,this.p=0}adv(e){this.p+=e}isDone(){return this.p>=this.src.length}c(){return this.src[this.p]}isMatch(e){return this.src.startsWith(e,this.p)}getSpace(){let e="";for(;!this.isDone();){const t=this.c();if(" "!==t&&"\n"!==t&&"\t"!==t)break;e+=t,this.adv(1)}return e}getWord(){let e="";for(;!this.isDone();){const t=this.c(),n=t.charCodeAt();if((n<97||n>122)&&45!==n&&95!==n&&(n<65||n>90)&&(n<48||n>57)&&n<128)break;e+=t,this.adv(1)}return e}getTill(e){const t=this.src.indexOf(e,this.p);if(t<0)throw new SyntaxError("Unexpected end of input");const n=this.src.slice(this.p,t);return this.p=t,n}ignoreTill(e){const t=this.src.indexOf(e,this.p);if(t<0)throw new SyntaxError("Unexpected end of input");this.p=t+e.length}parseTags(){const e=[];for(;!this.isMatch("</");)if(this.isMatch("\x3c!--"))this.ignoreTill("--\x3e");else if(this.isMatch("<![CDATA["))this.adv(9),e.push(this.getTill("]]>")),this.adv(3);else if("<"===this.c())e.push(this.parseTag());else{const t=this.getSpace();"<"!==this.c()&&e.push(t+this.getTill("<"))}return e}parseTag(){this.adv(1);const e={};if(e.t=this.getWord(),""===e.t)throw new SyntaxError("No tag name");if(e.a=this.parseAttrs(),">"===this.c()){if(this.adv(1),e.c=this.parseTags(),this.adv(2),this.getWord()!==e.t)throw new SyntaxError("Start and end tag name do not match");if(this.getSpace(),">"!==this.c())throw new SyntaxError("Tag is not closed");this.adv(1)}else{if(!this.isMatch("/>"))throw new SyntaxError("Tag is not closed");e.c=[],this.adv(2)}return e}parseAttrs(){const e={};for(;;){this.getSpace();const t=this.getWord();if(""===t)break;let n;if("="===this.c()){this.adv(1);const e=this.c();if('"'!==e&&"'"!==e)throw new SyntaxError("Attribute value does not start with \" or '");this.adv(1),n=this.getTill(e),this.adv(1)}else n=t;e[t]=n}return e}parse(e){this.init(e+"</");const t=this.parseTags();if(this.p!==this.src.length-2)throw new SyntaxError("Unexpected end tag");if(1!==t.length)throw new Error("Create only one root element in your template");return this.init(""),t[0]}}function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function s(e,t){if(null==t||"function"!=typeof t.onerror)throw e;t.onerror(e)}function o(e,t,n,i){e._f=e._f||{};const o=e._f;r(o,t)||(o[t]=new Function("event",n));const a=o[t].bind(i);return e=>{try{const t=a(e);return null!=t&&"function"==typeof t.catch?t.catch((e=>s(e,i))):t}catch(e){s(e,i)}}}function a(e){if(r(e,"_parsedTemplate"))return;const t=e.prototype.template();null!=t&&(e._parsedTemplate=c.parse(t))}const l=new WeakMap;class c{static parse(e){return(new i).parse(e)}static build(e,t=null,n=Object.create(null)){if("string"==typeof e)return document.createTextNode(e);if(n[e.t]){const i={};for(const[n,r]of Object.entries(e.a))t&&"on"===n.slice(0,2)?i[n]=o(e,n,r,t):t&&"id"!==n&&(i[n]=r);const r=e.c.map((e=>c.build(e,t,n))),s=new n[e.t](i,r);return t&&e.a&&e.a.id&&(t[e.a.id]=s),s.element}{const i=document.createElement(e.t);for(const[n,r]of Object.entries(e.a))t&&"id"===n?t[r]=i:t&&"on"===n.slice(0,2)?i[n]=o(e,n,r,t):i.setAttribute(n,r);for(const r of e.c)i.appendChild(c.build(r,t,n));return i}}static create(e,t={},n){return c.createElement(e,t,n),t}static createElement(e,t,n){const i=c.build(c.parse(e),t,n);return c.bindElement(t,i),i}static bindElement(e,t){null!=e&&null==e.element&&(e.element=t,l.set(t,e))}static from(e){return l.get(e)}static camelToKebab(e){return(e.slice(0,1)+e.slice(1).replace(/([A-Z])/g,"-$1")).toLowerCase()}constructor(){if(a(this.constructor),null!=this.constructor._parsedTemplate){const e=c.build(this.constructor._parsedTemplate,this,this.constructor._SubComponents);c.bindElement(this,e)}}template(){throw new Error('Please override "template()" method in the class extends TComponent')}uses(...e){r(this.constructor,"_SubComponents")||(this.constructor._SubComponents=Object.create(null));const t=this.constructor._SubComponents;for(const n of e)a(n),r(n.prototype,"tagName")||(n.prototype.tagName=n.name),t[n.prototype.tagName]=n,t[c.camelToKebab(n.prototype.tagName)]=n}}c.version="0.2.7";const d=c},1268:(e,t,n)=>{function i(e=null,t=null){if(t=t||document.body,!e)return t;if(e.firstElementChild)return e.firstElementChild;for(;e!==t;){if(e.nextElementSibling)return e.nextElementSibling;e=e.parentElement}return null}function r(e=null,t=null){if(e===(t=t||document.body))return null;if(e){if(!e.previousElementSibling)return e.parentElement;e=e.previousElementSibling}else e=t;for(;e.lastElementChild;)e=e.lastElementChild;return e}function s(e){if(!(e instanceof window.HTMLElement))return!1;const t=e.getAttribute("tabIndex");return null==t?"A"===e.tagName?!!e.href:["BUTTON","INPUT","SELECT","TEXTAREA"].includes(e.tagName)&&!e.disabled:t-0>=0}function o(e=null,t=null){let n=1;if(null!=e){const r=Math.max(0,e.tabIndex);for(;e=i(e,t);)if(s(e)&&e.tabIndex===r)return e;if(0===r)return null;e=null,n=r+1}let r=Number.POSITIVE_INFINITY,o=null;for(;e=i(e,t);){if(!s(e))continue;const t=e.tabIndex||Number.MAX_SAFE_INTEGER;t>=n&&r>t&&(r=t,o=e)}return o}function a(e=null,t=null){let n=Number.POSITIVE_INFINITY;if(null!=e){const i=Math.max(0,e.tabIndex);for(;e=r(e,t);)if(s(e)&&e.tabIndex===i)return e;if(1===i)return null;e=null,n=0===i?Number.MAX_SAFE_INTEGER:i-1}let i=-1,o=null;for(;e=r(e,t);){if(!s(e))continue;const t=e.tabIndex||Number.POSITIVE_INFINITY;t<=n&&i<t&&(i=t,o=e)}return o}n.d(t,{CD:()=>a,Wq:()=>s,rO:()=>o})},4857:(e,t,n)=>{n.d(t,{Un:()=>o,ZP:()=>a,dR:()=>s});let i=!1;const r=[];function s(){i=!0}function o(){if(i=!1,0===r.length)return;const e=document.createElement("style");e.textContent=r.join("\n"),document.head.appendChild(e),r.length=0}function a(...e){r.push(...e),i||o()}},604:(e,t,n)=>{n.d(t,{NL:()=>d,Vq:()=>o,Z9:()=>l,ZB:()=>u,eB:()=>h,iG:()=>c,vf:()=>a});var i=n(1804),r=n(4857),s=n(1268);class o extends i.Z{template(){const e="t-component-ui-dialog";return(0,r.ZP)(`\n      .${e} {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        outline: none;\n      }\n      .${e} > .background {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        z-index: -1;\n      }\n      .${e} > .dialog {\n        background: #FFF;\n        border: 1px solid #999;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.25);\n        display: flex;\n        flex-flow: column nowrap;\n        color: #000;\n        background: #FFF;\n      }\n      .${e} > .dialog > .title {\n        flex: none;\n        padding: 4px;\n        color: #000;\n        background: #EEE;\n      }\n      .${e} > .dialog > .body {\n        flex: auto;\n        padding: 10px;\n      }\n      .${e} > .dialog > .buttons {\n        flex: none;\n        display: flex;\n        justify-content: flex-end;\n        padding: 0 5px;\n      }\n      .${e} > .dialog > .buttons > button {\n        width: 75px;\n        margin: 5px;\n        white-space: nowrap;\n      }\n    `),`\n      <div class="${e}" onkeydown="this.handleKeyDown(event)" tabindex="-1">\n        <div class="background"></div>\n        <div class="dialog">\n          <div id="title" class="title">${this.titleTemplate()}</div>\n          <div id="body" class="body">${this.bodyTemplate()}</div>\n          <div id="buttons" class="buttons">${this.buttonsTemplate()}</div>\n        </div>\n      </div>\n    `}titleTemplate(){return""}bodyTemplate(){return""}buttonsTemplate(){return""}constructor(e={},t=[]){super(),this.resolve=e.resolve}handleOK(e){this.resolve(null)}handleCancel(e){this.resolve(null)}handleKeyDown(e){e.stopPropagation();let t=document.activeElement;switch(e.keyCode){case 13:"BUTTON"!==e.target.tagName&&"function"==typeof this.handleOK&&this.handleOK(e);break;case 27:"function"==typeof this.handleCancel&&this.handleCancel(e);break;case 37:case 38:"BUTTON"===t.tagName&&this.buttons.contains(t)&&(t=(0,s.CD)(t,this.buttons),t||(t=(0,s.CD)(t,this.buttons)),t&&t.focus());break;case 39:case 40:"BUTTON"===t.tagName&&this.buttons.contains(t)&&(t=(0,s.rO)(t,this.buttons),t||(t=(0,s.rO)(t,this.buttons)),t&&t.focus())}}}function a(e){return async function(...t){await new Promise((e=>window.requestAnimationFrame(e)));const n=document.activeElement;let r,o=null;const a=await new Promise((n=>{r=new e(Object.assign({resolve:n},{arguments:t})),document.body.appendChild(r.element);const a=(0,s.rO)(null,r.element);if(a){const e=(0,s.CD)(null,r.element);o=i.Z.createElement('<div style="position: absolute; overflow: hidden; width: 0;"><input onfocus="this.handleFocus(event)" tabindex="1" /></div>',{handleFocus(e){a.focus()}}),document.body.insertBefore(o,document.body.firstChild),r.element.addEventListener("keydown",(t=>{if(9===t.keyCode&&!1===t.ctrlKey&&!1===t.altKey){const n=(0,s.Wq)(t.target);!t.shiftKey||n&&t.target!==a?t.shiftKey||n&&t.target!==e||(t.preventDefault(),a.focus()):(t.preventDefault(),e.focus())}})),a.focus(),a instanceof window.HTMLInputElement&&a.select()}r.main&&r.main()}));return document.body.removeChild(r.element),o&&document.body.removeChild(o),n.focus(),await new Promise((e=>window.requestAnimationFrame(e))),a}}const l=a(class extends o{bodyTemplate(){return'\n      <p id="text" style="white-space: pre-wrap;"></p>\n    '}buttonsTemplate(){return'\n      <button id="okButton" onclick="return this.handleOK(event)">OK</button>\n    '}constructor(e={},t=[]){super(e,t);const[n="",i="情報"]=e.arguments;this.title.textContent=i,this.text.textContent=n}}),c=a(class extends o{bodyTemplate(){return'\n      <p id="text" style="white-space: pre-wrap;"></p>\n    '}buttonsTemplate(){return'\n      <button id="okButton" onclick="return this.handleOK(event)">はい</button>\n      <button onclick="return this.handleCancel(event)">いいえ</button>\n    '}constructor(e={},t=[]){super(e,t);const[n="",i="確認"]=e.arguments;this.title.textContent=i,this.text.textContent=n}handleOK(e){this.resolve(!0)}handleCancel(e){this.resolve(!1)}});class d extends o{bodyTemplate(){return'\n      <form onsubmit="event.preventDefault()">\n        <p id="text" style="white-space: pre-wrap;"></p>\n        <input id="input" />\n      </form>\n    '}buttonsTemplate(){return'\n      <button onclick="return this.handleOK(event)">OK</button>\n      <button onclick="return this.handleCancel(event)">キャンセル</button>\n    '}constructor(e={},t=[]){super(e,t);const[n="",i="",r="入力"]=e.arguments;this.title.textContent=r,this.text.textContent=n,this.input.value=i}handleOK(e){this.resolve(this.input.value)}}const h=a(d);async function u(e="",t=!1){return await new Promise((n=>{const r=i.Z.createElement(`<input type="file" accept="${e}" ${t?"multiple":""} hidden />`);r.onchange=e=>{n(t?r.files:r.files[0])},window.addEventListener("focus",(function e(t){window.removeEventListener("focus",e),setTimeout(n,1e3,null)})),document.body.appendChild(r),r.click(),document.body.removeChild(r)}))}}},r={};function s(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={id:e,exports:{}};return i[e].call(n.exports,n,n.exports,s),n.exports}s.m=i,e=[],s.O=(t,n,i,r)=>{if(!n){var o=1/0;for(d=0;d<e.length;d++){for(var[n,i,r]=e[d],a=!0,l=0;l<n.length;l++)(!1&r||o>=r)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,r<o&&(o=r));if(a){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,i,r]},s.F={},s.E=e=>{Object.keys(s.F).map((t=>{s.F[t](e)}))},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="haiix-editor:",s.l=(e,i,r,o)=>{if(t[e])t[e].push(i);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var h=c[d];if(h.getAttribute("src")==e||h.getAttribute("data-webpack")==n+r){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",n+r),a.src=e),t[e]=[i];var u=(n,i)=>{a.onerror=a.onload=null,clearTimeout(p);var r=t[e];if(delete t[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(i))),n)return n(i)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={179:0};s.f.j=(t,n)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,r)=>i=e[t]=[n,r]));n.push(i[2]=r);var o=s.p+s.u(t),a=new Error;s.l(o,(n=>{if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,i[1](a)}}),"chunk-"+t,t)}},s.F.j=t=>{if(!s.o(e,t)||void 0===e[t]){e[t]=null;var n=document.createElement("link");s.nc&&n.setAttribute("nonce",s.nc),n.rel="prefetch",n.as="script",n.href=s.p+s.u(t),document.head.appendChild(n)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var i,r,[o,a,l]=n,c=0;if(o.some((t=>0!==e[t]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);if(l)var d=l(s)}for(t&&t(n);c<o.length;c++)r=o[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},n=self.webpackChunkhaiix_editor=self.webpackChunkhaiix_editor||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0,s.O(0,[179],(()=>{[191,1,498,834].map(s.E)}),5);var o={};(()=>{var e=s(1268),t=s(4857);t.dR();var n=s(1804);function i(e,t,n=""){return(e[t]??n)+""}function r(e,t,n=!1){return null!=e[t]?e[t]===t||!0===e[t]:n}function o(e,t){return"function"==typeof e[t]?e[t]:null}function a(e,t,n){for(const s of n)switch(s.type){case"string":e[s.name]=i(t,s.name,s.default);break;case"boolean":e[s.name]=r(t,s.name,s.default);break;case"function":e[s.name]=o(t,s.name);break;default:throw new Error("Undefied type: "+s.type)}for(const[i,r]of Object.entries(t))n.find((e=>e.name===i))||("function"==typeof r?e.client[i]=r:e.setAttribute(i,r))}function l(e){return n.Z.from(e)??e}class c extends n.Z{template(){return this.tagName="t-element","\n      <div id='client'></div>\n    "}constructor(e={},t=[]){super(),this.client=this.client??this.element;for(const e of t)this.appendChild(e)}get textContent(){return this.client.textContent}set textContent(e){this.client.textContent=e}get innerHTML(){return this.client.innerHTML}set innerHTML(e){this.client.innerHTML=e}get parentNode(){return l(this.client.parentNode)}get childNodes(){return[...this]}get childElementCount(){return this.client.childElementCount}get firstChild(){return l(this.client.firstChild)}get lastChild(){return l(this.client.lastChild)}get previousSibling(){return l(this.client.previousSibling)}get nextSibling(){return l(this.client.nextSibling)}get classList(){return this.client.classList}appendChild(e){return this.client.appendChild(e?.element??e)}removeChild(e){return this.client.removeChild(e?.element??e)}insertBefore(e,t){return this.client.insertBefore(e?.element??e,t?.element??t)}getAttribute(e){return this.client.getAttribute(e)}setAttribute(e,t){return this.client.setAttribute(e,t)}contains(e){return this.client.contains(e.element??e)}addEventListener(e,t,n){return this.client.addEventListener(e,t,n)}removeEventListener(e,t,n){return this.client.removeEventListener(e,t,n)}dispatchEvent(e){return this.client.dispatchEvent(e)}*[Symbol.iterator](){for(const e of this.client.childNodes)yield l(e)}}const d=e=>Array.isArray(e)?e:Array.from(e);class h{constructor(e){this._ite=e}concat(...e){return new h([this._ite,...e]).flat()}entries(){return this.map(((e,t)=>[t,e]))}every(e,t=null){return!this.map(e,t).map((e=>!!e)).includes(!1)}fill(e,t=0,n=Number.MAX_SAFE_INTEGER){return t<0||n<0?new h(d(this._ite).fill(...arguments)):this.map(((i,r)=>r>=t&&r<n?e:i))}filter(e,t=null){return this.flatMap(((n,i,r)=>e.call(t,n,i,r)?[n]:[]))}find(e,t=null){for(const[n,i]of this.entries())if(e.call(t,i,n,this._ite))return i}findIndex(e,t=null){for(const[n,i]of this.entries())if(e.call(t,i,n,this._ite))return n;return-1}flat(e=1){return new h(function*e(t,n){for(const i of t)n>0&&null!==i&&"function"==typeof i[Symbol.iterator]?yield*e(i,n-1):yield i}(this._ite,e))}flatMap(e,t){return this.map(e,t).flat()}forEach(e,t=null){this.map(e,t).fill(0).indexOf(1)}includes(e,t=0){return this.indexOf(e,t)>=0}indexOf(e,t=0){return t<0?d(this._ite).indexOf(...arguments):this.findIndex(((n,i)=>i>=t&&n===e))}join(e=","){return d(this._ite).join(...arguments)}keys(){return this.map(((e,t)=>t))}lastIndexOf(e,t){return d(this._ite).lastIndexOf(...arguments)}map(e,t=null){return new h(function*(n,i){for(const r of n)yield e.call(t,r,++i,n)}(this._ite,-1))}reduce(e,t){let n=t;for(const[t,i]of this.entries())n=0===t&&1===arguments.length?i:e(n,i,t,this._ite);return n}reduceRight(e,t){return d(this._ite).reduceRight(...arguments)}slice(e=0,t=Number.MAX_SAFE_INTEGER){return new h(e<0||t<0?d(this._ite).slice(...arguments):function*(n,i){for(const r of n){if(++i>=t)return;i>=e&&(yield r)}}(this._ite,-1))}some(e,t=null){return this.map(e,t).map((e=>!!e)).includes(!0)}toString(){return this.join("")}values(){return new h(this._ite)}[Symbol.iterator](){return this._ite[Symbol.iterator]()}}function u(e){if("number"==typeof e)return new h(Array(e).keys());if(e instanceof h)return e;if("function"==typeof e[Symbol.iterator])return new h(e);throw new TypeError("The given argument is not a number or iterable.")}function p(e,t,n,i){if(!t)return;let r;try{r=t.apply(e,n)}catch(t){i&&i.call(e,t)}i&&null!=r&&"function"==typeof r.then&&async function(t){try{await t}catch(t){i.call(e,t)}}(r)}function f(e){return[e.touches?.[0]?.clientX??e.pageX,e.touches?.[0]?.clientY??e.pageY]}function m({ondragstart:e=null,ondrag:t=null,ondragend:n=null,onerror:i=null,cursor:r="",bind:s=null,container:o=document.body}){let a=null;const l=n=>{n.preventDefault();const[l,c]=f(n);a||(a=document.createElement("div"),a.setAttribute("style","position: fixed; top: 0; left: 0; right: 0; bottom: 0;"),r&&(a.style.cursor=r),o.appendChild(a),p(s,e,[l,c,a],i)),p(s,t,[l,c,a],i)},c=e=>{e.preventDefault();const[t,r]=f(e);window.removeEventListener("touchmove",l),window.removeEventListener("touchend",c),window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",c),a&&o.removeChild(a),p(s,n,[t,r,a],i)};window.addEventListener("touchmove",l,{passive:!1}),window.addEventListener("touchend",c,{passive:!1}),window.addEventListener("mousemove",l,{passive:!1}),window.addEventListener("mouseup",c,{passive:!1})}function b(e){return e.element||"LI"===e.tagName?e:new w({},[e])}(0,t.ZP)("\n  @font-face {\n    font-family: 'Material Icons';\n    font-style: normal;\n    font-weight: 400;\n    font-display: block;\n    src: url(./resources/vendor/MaterialIcons-Regular.ttf) format('truetype');\n  }\n\n  .material-icons {\n    font-family: 'Material Icons';\n    font-weight: normal;\n    font-style: normal;\n    font-size: 24px;\n    display: inline-block;\n    line-height: 1;\n    text-transform: none;\n    letter-spacing: normal;\n    word-wrap: normal;\n    white-space: nowrap;\n    direction: ltr;\n    -webkit-font-smoothing: antialiased;\n    text-rendering: optimizeLegibility;\n    -moz-osx-font-smoothing: grayscale;\n    font-feature-settings: 'liga';\n  }\n");class g extends c{template(){return this.tagName="t-list",'<ul id="client" onmousedown="return this._handleMouseDown(event)"></ul>'}constructor(e={},t=[]){super(e,t),a(this,e,[{name:"name",type:"string"},{name:"disabled",type:"boolean"},{name:"onmousedown",type:"function"}]),this._current=[...this].find((e=>e.current))}appendChild(e){return super.appendChild(b(e))}insertBefore(e,t){return super.insertBefore(b(e),t)}get(e){return[...this].find((t=>t.value===e))}set value(e){this.current=this.get(e)}get value(){return this.current?.value}set current(e){if(null!=e){if([...this].indexOf(e)<0||this._current===e)return;e.classList.add("current")}this.current&&this.current.classList.remove("current"),this._current=e,this.dispatchEvent(new window.CustomEvent("change",{detail:e}))}get current(){return this._current}set disabled(e){e?this.classList.add("disabled"):this.classList.remove("disabled")}get disabled(){return this.classList.contains("disabled")}_handleMouseDown(e){if(this.onmousedown&&!1===this.onmousedown(e))return;if(e.defaultPrevented||this.disabled||0!==e.button)return;const t=[...this].find((t=>t.contains(e.target)));t&&(this.current===t||t.disabled||window.requestAnimationFrame((()=>{this.current=t})))}}class w extends c{template(){return this.tagName="t-list-item",'<li id="client"></li>'}constructor(e={},t=[]){super(e,t),a(this,e,[{name:"value",type:"string"},{name:"disabled",type:"boolean"},{name:"current",type:"boolean"},{name:"selected",type:"boolean"}])}set disabled(e){e?this.classList.add("disabled"):this.classList.remove("disabled")}get disabled(){return this.classList.contains("disabled")}set current(e){e?this.classList.add("current"):this.classList.remove("current")}get current(){return this.classList.contains("current")}set selected(e){e?this.classList.add("selected"):this.classList.remove("selected")}get selected(){return this.classList.contains("selected")}}g.Item=w;const v=g;var y=s(604);class x extends n.Z{template(){const e="my-flie-list-context-menu";return(0,t.ZP)(`\n      .${e} {\n        display: inline-block;\n        position: absolute;\n        background: #FFF;\n        border: 1px solid #999;\n        padding: 2px 0;\n        box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);\n      }\n      .${e} > * {\n        display: block;\n        line-height: 20px;\n        padding: 0 10px;\n        border: 1px solid transparent;\n        white-space: nowrap;\n      }\n      .${e} > * > * {\n        vertical-align: middle;\n      }\n      .${e} > * > .material-icons {\n        font-size: 16px;\n        position: relative;\n        left: -6px;\n      }\n      .${e} > hr {\n        border-top: 1px solid #CCC;\n        margin: 4px;\n      }\n      .${e} > .current:not(.disabled) {\n        border: 1px solid #BDF;\n        background: #DEF;\n      }\n    `),`\n      <div class="${e}" id="contextMenu"\n        onmousedown="return this.handleMouseDown(event)"\n        onmouseup="return this.handleMouseUp(event)"\n        onmouseleave="return this.handleMouseLeave(event)">\n        ${this.menuTemplate()}\n      </div>\n    `}constructor(e={},t=[]){super(),this._resolve=e.resolve;const[n]=e.arguments;let i=0,r=0;if(n instanceof MouseEvent)i=n.pageX,r=n.pageY;else if(n instanceof HTMLElement){const e=n.getBoundingClientRect();i=e.left,r=e.bottom}this.element.style.top=r+"px",this.element.style.left=i+"px";const s=e=>{this.element.contains(e.target)||o(e)},o=e=>{this.resolve(null)},a=e=>{if(e.target===this.contextMenu||!this.contextMenu.contains(e.target))return;let t=e.target;for(;t.parentNode!==this.contextMenu;)t=t.parentNode;const n=this.current;n!==t&&(n&&n.classList.remove("current"),t.classList.add("current"))},l=e=>{e.stopPropagation();const t=this.current;switch(e.keyCode){case 13:this.resolve(t.dataset.value);break;case 27:this.resolve(null);break;case 38:{const e=this.contextMenu.lastElementChild;if(t){t.classList.remove("current");let n=t;do{if(n=n.previousElementSibling||e,!n.classList.contains("disabled"))break}while(n!==t);n.classList.add("current")}else e.classList.add("current")}break;case 40:{const e=this.contextMenu.firstElementChild;if(t){t.classList.remove("current");let n=t;do{if(n=n.nextElementSibling||e,!n.classList.contains("disabled"))break}while(n!==t);n.classList.add("current")}else e.classList.add("current")}}};this.resolve=e=>{window.removeEventListener("mousedown",s,!0),window.removeEventListener("mousemove",a,!0),window.removeEventListener("blur",o,!0),window.removeEventListener("keydown",l,!0),this._resolve(e)},window.addEventListener("mousedown",s,!0),window.addEventListener("mousemove",a,!0),window.addEventListener("blur",o,!0),window.addEventListener("keydown",l,!0)}get current(){return Array.from(this.contextMenu.children).find((e=>e.classList.contains("current")))}handleMouseDown(e){e.preventDefault()}handleMouseUp(e){if(0!==e.button&&2!==e.button)return;let t=e.target;for(;t&&t.parentNode!==this.element;)t=t.parentNode;t&&!t.classList.contains("disabled")&&this.resolve(t.dataset.value)}handleMouseLeave(e){const t=this.current;t&&t.classList.remove("current")}}function C(e){return(0,y.vf)(class extends x{menuTemplate(){return e}})}const E="t-component-ui-tree";(0,t.ZP)(`\n  .${E} {\n    cursor: default;\n    outline: none;\n    overflow: auto;\n    background: #FFF;\n    color: #000;\n    user-select: none;\n  }\n  .${E} ul {\n    margin: 0;\n    padding: 0;\n    list-style-type: none;\n    min-width: max-content;\n  }\n  .${E} li > div {\n    white-space: nowrap;\n    height: 24px;\n    line-height: 0;\n  }\n  .${E} li > div > * {\n    vertical-align: middle;\n  }\n  .${E} li > div:first-child::before {\n    content: "";\n    display: inline-block;\n    height: 100%;\n    vertical-align: middle;\n  }\n  .${E} li > div:hover {\n    background: #DEF;\n  }\n  .${E} li.current > div {\n    background: #DDD;\n  }\n  .${E}:focus li.current > div {\n    background: #BDF;\n  }\n  .${E} .expand-icon {\n    display: inline-block;\n    margin-right: 2px;\n    font-size: 18px;\n    color: #666;\n    opacity: 0;\n    transition: opacity .5s;\n  }\n  .${E}:focus .expand-icon,\n  .${E}:hover .expand-icon {\n    opacity: 1;\n  }\n  .${E} .expand-icon:hover {\n    color: #3CF;\n  }\n  .${E} .icon {\n    display: inline-block;\n    margin-right: 4px;\n    font-size: 18px;\n  }\n`);class T extends n.Z{set textContent(e){if(""!==e)throw new Error("Only empty string can be set.");this._list.textContent="",this.current=null}get textContent(){return this.element.textContent}get firstChild(){return n.Z.from(this._list.firstChild)}get lastChild(){return n.Z.from(this._list.lastChild)}appendChild(e){return this.insertBefore(e,null)}insertBefore(e,t=null){if(!(e instanceof k))throw new Error("The object is not a tree item.");this._list.insertBefore(e._item,t?t._item:null);const n=this._getIndent();return Number.isNaN(n)||e._setIndent(n+1),e}removeChild(e){if(e.parentNode!==this)throw new Error("The object is not a child of this node.");const t=this.getRootNode();t.current&&e._item.contains(t.current._item)&&(t.current=e.nextSibling||e.previousSibling||(this instanceof k?this:null)),this._list.removeChild(e.element)}get childElementCount(){return this._list.childElementCount}*[Symbol.iterator](){let e=this._list.firstChild;for(;e;)yield n.Z.from(e),e=e.nextSibling}}class k extends T{template(){return this.tagName="ui-tree-item",'\n      <li id="_item">\n        <div id="_container">\n          <i id="_expandIcon" class="material-icons expand-icon">chevron_right</i>\n          <i id="_icon" class="material-icons icon" style="color: #FC9;">folder</i>\n          <span id="_text"></span>\n        </div>\n        <ul id="_list" style="display: none;"></ul>\n      </li>\n    '}set text(e){this._text.textContent=e}get text(){return this._text.textContent}set html(e){this._text.innerHTML=e}get html(){return this._text.innerHTML}set icon(e){this._icon.textContent=e}get icon(){return this._icon.textContent}set iconColor(e){this._icon.style.color=e}get iconColor(){return this._icon.style.color}get parentNode(){return n.Z.from(this._item.parentNode.parentNode)}get previousSibling(){return n.Z.from(this._item.previousSibling)}get nextSibling(){return n.Z.from(this._item.nextSibling)}async expand(){const e=this.getRootNode();if(e.onexpand){this._expandIcon.textContent="autorenew";const t=new window.CustomEvent("expand",{detail:this});await e.onexpand(t)}this._expandIcon.textContent="expand_more",this._list.style.display="",this._item.classList.add("expanded")}async collapse(){const e=this.getRootNode();if(e.oncollapse){this._expandIcon.textContent="autorenew";const t=new window.CustomEvent("collapse",{detail:this});await e.oncollapse(t)}this._expandIcon.textContent="chevron_right",this._list.style.display="none",this._item.classList.remove("expanded");const t=this.getRootNode();t.current&&this._item.contains(t.current._item)&&(t.current=this)}get isExpanded(){return"none"!==this._list.style.display}set isExpandable(e){e?this._expandIcon.textContent="chevron_right":(this._expandIcon.textContent="_",this._list.style.display="none")}get isExpandable(){return"_"!==this._expandIcon.textContent}getRootNode(){let e=this;for(;e instanceof k;)e=e.parentNode;return e instanceof _?e:null}getPath(){const e=[];let t=this;for(;t instanceof k;)e.unshift(t),t=t.parentNode;return e}_setIndent(e){this._container.style.paddingLeft=e+"em";for(const t of this)t._setIndent(e+1)}_getIndent(){const e=this._container.style.paddingLeft;return""===e?NaN:e.slice(0,-2)>>0}}class _ extends T{template(){return this.tagName="ui-tree",'\n      <div id="_tree" tabindex="0"\n        ontouchstart="return this._handleTreeMousedown(event)"\n        onmousedown="return this._handleTreeMousedown(event)"\n        onkeydown="return this._handleTreeKeydown(event)"\n      >\n        <ul id="_list"></ul>\n      </div>\n    '}constructor(e,t){super(),this.current=null,this.onexpand=null,this.oncollapse=null,this.ontouchstart=null,this.onmousedown=null,this.onkeydown=null;for(const[t,n]of Object.entries(e))"string"==typeof n?this._tree.setAttribute(t,n):"on"===t.slice(0,2)&&"onexpand"!==t&&"oncollapse"!==t&&"ontouchstart"!==t&&"onmousedown"!==t&&"onkeydown"!==t?this._tree[t]=n:this[t]=n;this._tree.classList.add(E)}getRootNode(){return this}_getIndent(){return-1}set current(e){if(!(e instanceof k)&&null!=e)throw new Error("The object is not a tree item.");this._lastCurrent!==e&&(null!=this._lastCurrent&&this._lastCurrent._item.classList.remove("current"),this._lastCurrent=e,e&&(e._item.classList.add("current"),e._container.scrollIntoView({block:"nearest",inline:"nearest"})),this._tree.dispatchEvent(new window.CustomEvent("change",{detail:e})))}get current(){return null!=this._lastCurrent&&this._lastCurrent._item.classList.contains("current")||(this._lastCurrent=n.Z.from(this._tree.querySelector(".current"))),this._lastCurrent}focus(){this._tree.focus()}async _handleTreeMousedown(e){if("function"==typeof this.ontouchstart&&(!1===this.ontouchstart(e)||e.defaultPrevented))return;if("function"==typeof this.onmousedown&&(!1===this.onmousedown(e)||e.defaultPrevented))return;let t=e.target;for(;"LI"!==t.tagName;){if(t===this._tree)return;t=t.parentNode}const i=n.Z.from(t);e.target===i._expandIcon&&i.isExpandable?"touchstart"!==e.type&&0!==e.button||(i.isExpanded?await i.collapse():await i.expand()):1!==e.button&&(this.current=i)}async _handleTreeKeydown(e){if(("function"!=typeof this.onkeydown||!1!==this.onkeydown(e)&&!e.defaultPrevented)&&this.current)switch(e.keyCode){case 8:e.preventDefault(),this.current.parentNode!==this&&(this.current=this.current.parentNode);break;case 37:e.preventDefault(),this.current.isExpanded?await this.current.collapse():this.current.parentNode!==this&&(this.current=this.current.parentNode);break;case 38:if(e.preventDefault(),this.current._item.previousSibling){let e=n.Z.from(this.current._item.previousSibling);for(;e.isExpanded&&e._list.lastChild;)e=n.Z.from(e._list.lastChild);this.current=e}else this.current.parentNode!==this&&(this.current=this.current.parentNode);break;case 39:e.preventDefault(),this.current.isExpandable&&!this.current.isExpanded?await this.current.expand():this.current._list.firstChild&&(this.current=n.Z.from(this.current._list.firstChild));break;case 40:if(e.preventDefault(),this.current.isExpanded&&this.current._list.firstChild)this.current=n.Z.from(this.current._list.firstChild);else{let e=this.current;for(;e!==this&&!e._item.nextSibling;)e=e.parentNode;e!==this&&(this.current=n.Z.from(e._item.nextSibling))}}}}async function F(e,t,n,i){const r=await function({name:e="",version:t=1,onupgradeneeded:n=null}){return new Promise(((i,r)=>{const s=self.indexedDB.open(e,t);s.onupgradeneeded=e=>{try{n(s.result,s.transaction,e.oldVersion)}catch(e){r(e)}},s.onsuccess=e=>{i(s.result)},s.onerror=e=>{r(e.target.error)}}))}(e);return await new Promise(((e,s)=>{let o;const a=r.transaction(t,n);a.oncomplete=t=>{r.close(),e(o)},a.onerror=e=>{r.close(),s(e.target.error)};try{o=i(a)}catch(e){a.abort(),r.close(),s(e)}}))}function S(e,t){return new Promise(((n,i)=>{const r=e.add(t);r.onsuccess=e=>{n(r.result)},r.onerror=e=>{i(e.target.error)}}))}function L(e,t){return new Promise(((n,i)=>{const r=e.put(t);r.onsuccess=e=>{n(r.result)},r.onerror=e=>{i(e.target.error)}}))}function j(e,t){return new Promise(((n,i)=>{const r=e.get(t);r.onsuccess=e=>{n(r.result)},r.onerror=e=>{i(e.target.error)}}))}function N({index:e,range:t=null,direction:n="next",forEach:i}){return new Promise(((r,s)=>{let o;const a=e.openCursor(t,n);a.onsuccess=e=>{const t=a.result;if(t){try{o=i(t.value,t)}catch(e){s(e)}t.advance(void 0===o?1:4294967295)}else r(o)},a.onerror=e=>{s(e.target.error)}}))}_.Item=k;class I{constructor(e){this.firstTime=!1,this.dbSchema={name:e,version:1,onupgradeneeded:(e,t,n)=>{n<1&&(this.firstTime=!0,e.createObjectStore("files",{keyPath:"id",autoIncrement:!0}).createIndex("path","path",{unique:!0}))}},this.workspace="workspace1/"}initWorkSpaces(){return F(this.dbSchema,["files"],"readwrite",(e=>{const t=e.objectStore("files");for(let e=1;e<=4;e++)S(t,{path:"workspace"+e,label:"ワークスペース"+e,setting:this.createDefaultSetting()})}))}async getAllWorkSpaces(){const e=[];return await F(this.dbSchema,["files"],"readonly",(t=>N({index:t.objectStore("files").index("path"),forEach:t=>{t.path.includes("/")||(t.setting=this.createDefaultSetting(t.setting),e.push(t))}}))),e}async getAllFoldersAndFiles(){const e=[],t=[];return await F(this.dbSchema,["files"],"readonly",(n=>N({index:n.objectStore("files").index("path"),range:IDBKeyRange.lowerBound(this.workspace),forEach:n=>{if(!n.path.startsWith(this.workspace))return!1;(n=Object.assign({},n,{path:n.path.slice(this.workspace.length)})).file?t.push(n):e.push(n)}}))),{folders:e,files:t}}async getAllFiles(){const e=[];return await F(this.dbSchema,["files"],"readonly",(t=>N({index:t.objectStore("files").index("path"),range:IDBKeyRange.lowerBound(this.workspace),forEach:t=>{if(!t.path.startsWith(this.workspace))return!1;t=Object.assign({},t,{path:t.path.slice(this.workspace.length)}),e.push(t)}}))),e}async addFiles(e){await F(this.dbSchema,["files"],"readwrite",(t=>{const n=t.objectStore("files");for(const t of e)L(n,Object.assign({},t,{path:this.workspace+t.path}))}))}async removeFile(e){const t=[];return await F(this.dbSchema,["files"],"readwrite",(n=>N({index:n.objectStore("files").index("path"),range:IDBKeyRange.lowerBound(this.workspace+e),forEach:(n,i)=>{if(!(n.path+"/").startsWith(this.workspace+e+"/"))return!1;i.delete(n),t.push(n.path.slice(this.workspace.length))}}))),t}removeAllFiles(){return F(this.dbSchema,["files"],"readwrite",(e=>N({index:e.objectStore("files").index("path"),range:IDBKeyRange.lowerBound(this.workspace),forEach:(e,t)=>{if(!e.path.startsWith(this.workspace))return!1;t.delete()}})))}async moveFile(e,t){const n=[];return await F(this.dbSchema,["files"],"readwrite",(i=>N({index:i.objectStore("files").index("path"),range:IDBKeyRange.lowerBound(this.workspace+e),forEach:(i,r)=>{if(!(i.path+"/").startsWith(this.workspace+e+"/"))return!1;const s=i.path,o=this.workspace+t+i.path.slice((this.workspace+e).length);if(i.path=o,i.file){const e=this.getFileType(s),t=this.getFileType(o);e!==t&&(i.file=new Blob([i.file],{type:t}))}r.update(i),n.push([s.slice(this.workspace.length),o.slice(this.workspace.length)])}}))),n}putFile(e,t){return F(this.dbSchema,["files"],"readwrite",(n=>N({index:n.objectStore("files").index("path"),range:IDBKeyRange.only(this.workspace+e),forEach(e,n){e.file=t,n.update(e)}})))}async getFile(e){return(await F(this.dbSchema,["files"],"readonly",(t=>j(t.objectStore("files").index("path"),this.workspace+e))))?.file}putWorkSpaceSetting(e){return F(this.dbSchema,["files"],"readwrite",(t=>N({index:t.objectStore("files").index("path"),range:IDBKeyRange.only(this.workspace.slice(0,-1)),forEach(t,n){t.setting=e,n.update(t)}})))}async getWorkSpaceSetting(){const e=await F(this.dbSchema,["files"],"readonly",(e=>j(e.objectStore("files").index("path"),this.workspace.slice(0,-1))));return this.createDefaultSetting(e?.setting)}createDefaultSetting(e){return e??={},e.fileName??="",e.password??="",e.tabs??=[],e.currentTab??=null,e}getFileType(e){return{js:"text/javascript",mjs:"text/javascript",css:"text/css",html:"text/html",htm:"text/html",json:"application/json",xml:"application/xml",gif:"image/gif",png:"image/png",jpeg:"image/jpeg",jpg:"image/jpeg",svg:"image/svg+xml",txt:"text/plain",md:"text/markdown"}[e.slice(e.lastIndexOf(".")+1)]||null}}class M extends _{template(){const e=super.template();return this.tagName="file-tree",e}update(e,t){this.textContent="";for(const n of[...e,...t]){const[e,t]=this.getFolderAndName(n.path),i=this.createItem(t,!n.file);e.appendChild(i)}}createItem(e,t){const n=new _.Item;return n.text=e,t||(n.isExpandable=!1,n.icon="insert_drive_file",n.iconColor="#CCC"),n}insert(e,t){const n=t.text,i=u(e).find((e=>t.isExpandable?!e.isExpandable||e.text>n:!e.isExpandable&&e.text>n));return e.insertBefore(t,i),t}addFile(e){let t=null;for(const n of e){const[e,i]=this.getFolderAndName(n.path);t=this.createItem(i,!n.file),this.insert(e,t)}t&&(this.current=t)}remove(e){const t=this.getItem(e);t.parentNode.removeChild(t)}move(e,t){const[n,i]=this.getFolderAndName(t),r=this.getItem(e);r.text=i,this.insert(n,r),n!==this&&n.expand()}getFolderAndName(e){const t=e.split("/"),n=t.pop();return[this.getItem(t.join("/"))||this,n]}getItem(e){return e?e.split("/").reduce(((e,t)=>u(e).find((e=>e.text===t))||this.insert(e,this.createItem(t,!0))),this):this}getPath(e=this.current){const t=[];for(;e!==this;)t.unshift(e.text),e=e.parentNode;return t.join("/")}getFolderPath(e=this.current){if(!e)return"";!1===e.isExpandable&&(e=e.parentNode);let t=this.getPath(e);return""!==t&&(t+="/"),t}}class A extends n.Z{template(){const e="t-component-ui-splitter";return(0,t.ZP)(`\n      .${e} {\n        z-index: 4;\n        background: #CCC;\n        cursor: w-resize;\n        width: 1px;\n      }\n      .${e}::after {\n        content: "";\n        display: block;\n        /*background: yellow;*/\n        width: 9px;\n        height: 100%;\n        position: relative;\n        left: -4px;\n      }\n    `),this.tagName="ui-splitter",`\n      <div class="${e}" ontouchstart="return this.handleSplitter(event)" onmousedown="return this.handleSplitter(event)"></div>\n    `}constructor(e={},t=[]){super(),this.ondrag=e.ondrag}handleSplitter(e){e.preventDefault();const t=this.element.previousElementSibling,[n]=f(e),i=n-t.style.width.slice(0,-2);m({cursor:window.getComputedStyle(e.target).cursor,ondrag:e=>{t.style.width=Math.max(0,e-i)+"px",this.ondrag&&this.ondrag()}})}}function D(e,t){if(t===e)return null;for(;t&&t.parentNode!==e;)t=t.parentNode;return t}(0,t.ZP)('\nhtml, body {\n  font-family: "Segoe UI", "Yu Gothic UI", "Meiryo UI", "MS UI Gothic", monospace;\n  font-size: 9pt;\n  color: #000;\n  background: #FFF;\n  user-select: none;\n  cursor: default;\n}\nbutton {\n  font-family: inherit;\n  font-size: inherit;\n}\n',"\n.fullscreen {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: auto;\n  outline: none;\n}\n","\n.flex.row {\n  display: flex;\n}\n.flex.column {\n  display: flex;\n  flex-direction: column;\n}\nul.flex.row, ul.flex.column {\n  margin: 0;\n  padding: 0;\n  list-style-type: none;\n}\n.flex.row > *, .flex.column > * {\n  flex: none;\n}\n.flex.fit {\n  flex: auto;\n}\n");const O=C('\n  <div data-value="newFile">新規ファイル</div>\n  <div data-value="newFolder">新規フォルダー</div>\n  <div data-value="rename">名前の変更</div>\n  <div data-value="delete">削除</div>\n');class P extends v.Item{template(){return'\n      <li>\n        <span id="label" class="label"></span>\n        <span id="closeButton" class="material-icons close-button">close</span>\n      </li>\n    '}constructor(e={},t=[]){const n=Object.assign({},e);delete n.view,delete n.path,delete n.file,super(n,t),this.view=e.view,this.path=e.path,this.file=e.file,this.editor=null}get isModified(){return this.classList.contains("modified")}set isModified(e){e?this.classList.add("modified"):this.classList.remove("modified")}get path(){return this.value}set path(e){this.value=e,this.label.textContent=this.name,this.view.value=e}get name(){return this.path.slice(("/"+this.path).lastIndexOf("/"))}}!async function(n){let i=null;try{i=new n,i.init&&await i.init(),t.Un(),document.body.appendChild(i.element);const r=(0,e.rO)(null,i.element);r&&r.focus(),i.main&&await i.main(),window.app=i,i.loop&&function e(n){try{i.loop(n)}catch(e){if(t.Un(),!i.onerror)throw e;i.onerror(e)}window.requestAnimationFrame(e)}(0)}catch(e){if(t.Un(),i&&i.onerror)i.onerror(e);else{if(!n.prototype.onerror)throw e;n.prototype.onerror.call(null,e)}}}(class extends c{template(){return(0,t.ZP)("\n      .my-app .select-template-button, .select-template-choices button {\n        margin: 0;\n        padding: 0;\n        border: none;\n        text-align: inherit;\n        background: inherit;\n        color: #06C;\n        cursor: pointer;\n      }\n      .my-app .select-template-button:hover, .t-component-ui-dialog a:hover {\n        color: #39F;\n        text-decoration: underline;\n      }\n      .select-template-choices {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n      }\n      .select-template-choices button {\n        display: inline-block;\n        box-sizing: border-box;\n        width: 100%;\n        padding: 1em;\n      }\n      .select-template-choices button:hover {\n        background: #DEF;\n      }\n      .my-app .m-icon {\n        font-size: 18px;\n        width: 1em;\n      }\n      .my-app > * {\n        overflow: hidden;\n      }\n      .my-app .menubar {\n        background: #EEE;\n        border-bottom: 1px solid #CCC;\n      }\n      .my-app .menubar > * {\n        padding: 2px 8px;\n        border: 1px solid transparent;\n      }\n      .my-app .menubar > :hover {\n        border: 1px solid #9CF;\n        background: #DEF;\n      }\n      .my-app .menubar > .selected {\n        border: 1px solid #9CF;\n        background: #BDF;\n      }\n      .my-app .side-area > li:not(.current) {\n        display: none;\n      }\n      .my-app .side-area-empty {\n        justify-content: center;\n        align-items: center;\n        padding: 0 2em;\n      }\n      .my-app .file-tree {\n        height: 0;\n        min-height: 100%;\n      }\n      .my-app .file-tree .drop-target {\n        background: #BDF;\n      }\n      .my-app .main-area {\n        background: #EEE;\n      }\n      .my-app .main-area > li:not(.current) {\n        display: none;\n      }\n      .my-app .main-area-empty {\n        justify-content: center;\n        align-items: center;\n        padding: 0 4em;\n      }\n      .my-app .tab-views {\n        overflow: hidden;\n      }\n      .my-app .tabs {\n        border-bottom: 1px solid #999;\n        flex-wrap: wrap;\n        align-items: flex-end;\n      }\n      .my-app .tabs > li {\n        padding: 1px 5px 2px;\n        border: 1px solid #999;\n        border-bottom: none;\n        background: #EEE;\n        margin-right: -1px;\n        position: relative;\n        bottom: -1px;\n      }\n      .my-app .tabs > li:hover {\n        background: #DEF;\n      }\n      .my-app .tabs > li.current {\n        padding-bottom: 4px;\n        background: #FFF;\n      }\n      .my-app .tabs > li > * {\n        vertical-align: middle;\n      }\n      .my-app .tabs > li.modified > .label::before {\n        content: '*'\n      }\n      .my-app .tabs > li .close-button {\n        border: 1px solid transparent;\n        font-size: 12px;\n        padding: 1px;\n        margin-left: 4px;\n      }\n      .my-app .tabs > li .close-button:hover {\n        border: 1px solid #CCC;\n      }\n      .my-app .views {\n        background: #EEE;\n      }\n      .my-app .views > li {\n        width: 0;\n        height: 0;\n        min-width: 100%;\n        min-height: 100%;\n        display: none;\n        position: relative;\n        z-index: 0;\n        overflow: auto;\n      }\n      .my-app .views > li.current {\n        display: inline-block;\n      }\n\n      .my-app .CodeMirror {\n        font-family: Consolas, Inconsolata, Monospace;\n        font-size: 14px;\n        height: 100%;\n        line-height: 18px;\n      }\n      .my-app .CodeMirror-code > :not(:last-child) .CodeMirror-line::after {\n        font-family: Monospace;\n        position: absolute;\n        content: \"↓\";\n        color: #999;\n        font-size: 9px;\n      }\n      .my-app .CodeMirror-code > :last-child .CodeMirror-line::after {\n        position: absolute;\n        content: \"[EOF]\";\n        color: #999;\n      }\n      .my-app .cm-tab::before {\n        font-family: Monospace;\n        position: absolute;\n        content: '>';\n        color: #999;\n        font-size: 9px;\n      }\n      .my-app .cm-ideographic-space::before {\n        font-family: Monospace;\n        position: absolute;\n        content: '□';\n        color: #CCC;\n      }\n      .my-app .CodeMirror-hints {\n        font-size: 14px;\n      }\n    "),this.uses(M,A,v,v.Item),'\n      <div class="my-app fullscreen flex column"\n        ondragover="return this.handleDragOver(event)"\n        ondrop="return this.handleDrop(event)"\n        onkeydown="return this.handleKeyDown(event)"\n        tabindex="-1"\n      >\n        \x3c!-- メニュー --\x3e\n        <ul id="menubar" class="menubar flex row"\n          onmousedown="return this.handleMenuMouseDown(event)"\n          onclick="return this.handleMenuClick(event)"\n          oncontextmenu="event.preventDefault()"\n        >\n          <li data-key="workspace">ワークスペース▾</li>\n          <li data-key="newProject">新規プロジェクト</li>\n          <li data-key="loadProject">プロジェクトを開く</li>\n          <li data-key="saveProject">プロジェクトを保存</li>\n          <li data-key="run" class="flex row">\n            <i class="material-icons m-icon" style="color: #0A3;">\n              play_circle_outline\n            </i>\n            実行 (F5)\n          </li>\n        </ul>\n\n        <div class="flex row fit">\n          <t-list id="sideArea" class="flex column side-area" style="width: 160px;"\n            oncontextmenu="return this.handleFileTreeContextMenu(event)"\n          >\n            <t-list-item id="sideAreaEmpty" class="flex column fit side-area-empty current">\n              <p>\n                ファイルツリーが空です。<br />\n                このエリアで右クリックメニューを開くか、ウィンドウ外からファイルをドロップしてファイルを追加してください。\n                <br />\n                <button class="select-template-button" onclick="return this.handleSelectTemplate(event)">ここをクリックして「index.html」を作成することもできます。</button>\n              </p>\n            </t-list-item>\n            <t-list-item id="fileTreeArea" class="flex column fit">\n              \x3c!-- ファイルリスト --\x3e\n              <file-tree id="fileTree" class="file-tree"\n                ondblclick="return this.handleFileTreeDoubleClick(event)"\n                onmousedown="return this.handleFileTreeMouseDown(event)"\n                onkeydown="return this.handleFileTreeKeyDown(event)"\n              />\n            </t-list-item>\n          </t-list>\n          <ui-splitter ondrag="return this.handleDragSplitter(event)" onerror="return this.onerror(event)" />\n\n          <t-list id="mainArea" class="flex column fit main-area">\n            <t-list-item id="mainAreaEmpty" class="flex column fit main-area-empty current">\n              <p>左のツリーからファイルを選択し、Enterキー、ダブルクリック、またはこのエリアへドラッグ&ドロップしてファイルを開いてください。</p>\n            </t-list-item>\n            \x3c!-- タブとエディタ --\x3e\n            <t-list-item id="tabViews" class="flex column fit tab-views">\n              <t-list id="tabs" class="tabs flex row"\n                onchange="return this.handleTabChange(event)"\n                onmousedown="return this.handleTabMouseDown(event)"\n              ></t-list>\n              <t-list id="views" class="views flex fit row"></t-list>\n            </t-list-item>\n          </t-list>\n        </div>\n      </div>\n    '}constructor(e={},t=[]){super(),this.name=document.title,this.version="0.1.0",this.namespace=location.pathname.slice(1,location.pathname.lastIndexOf("/")),this.base=location.protocol+"//"+location.host+"/"+this.namespace+"/",this.idbFile=new I(this.namespace),this.debugWindow=null,this.projectSetting=null}async init(){if(window.addEventListener("beforeunload",this.handleClose.bind(this)),null==window.navigator.serviceWorker)throw new Error("ServiceWorkerが無効です");[this.projectSetting]=await Promise.all([this.idbFile.getWorkSpaceSetting(),this.refreshFileTree(),window.navigator.serviceWorker.register("./sw.js")])}async main(){this.idbFile.firstTime?(await this.idbFile.initWorkSpaces(),await this.createTemplateFiles(1)):await this.restoreTabs()}handleClose(e){this.debugWindow&&!this.debugWindow.closed&&this.debugWindow.close()}async refreshFileTree(){const{folders:e,files:t}=await this.idbFile.getAllFoldersAndFiles();this.fileTree.update(e,t),0===e.length&&0===t.length?this.sideArea.current=this.sideAreaEmpty:this.sideArea.current=this.fileTreeArea}async addFile(...e){await this.idbFile.addFiles(e),this.fileTree.addFile(e),this.sideArea.current=this.fileTreeArea}async deleteCurrentFileOrFolder(){const e=this.fileTree.getPath(),t=await this.idbFile.removeFile(e);for(const e of t){const t=this.tabs.get(e);t&&await this.closeTabs([t])}this.fileTree.remove(e),0===this.fileTree.childElementCount&&(this.sideArea.current=this.sideAreaEmpty)}async openTab(e,t=!0){if(null==this.tabs.get(e)){const t=await this.idbFile.getFile(e),n=new v.Item({value:e}),i=new P({view:n,path:e,file:t});if("image/"===t.type.slice(0,6)){const e=document.createElement("img");e.src=URL.createObjectURL(t),n.appendChild(e)}else await this.createEditor(i),i.editor.focus();this.tabs.appendChild(i),this.views.appendChild(n)}t&&(this.tabs.value=e,this.mainArea.current=this.tabViews,await this.saveTabs())}async createEditor(e){const[t,n]=await Promise.all([Promise.all([s.e(191),s.e(1)]).then(s.bind(s,9800)),e.file.text()]),i=t.default,r=document.createElement("textarea");r.value=n,e.view.appendChild(r);const o=i.fromTextArea(r,{lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,mode:{name:e.file.type,globalVars:!0},gutters:["CodeMirror-lint-markers"],lint:{esversion:12,asi:!0}});o.addOverlay({flattenSpans:!1,token(e,t){if(e.match("　"))return"ideographic-space";for(;null!=e.next()&&!e.match("　",!1););return null}}),o.on("keydown",((e,t)=>{if(13===t.keyCode&&""===e.getSelection()){const n=e.getCursor(),i=e.getLine(n.line);i.length-i.trimLeft().length>=n.ch?(t.preventDefault(),e.replaceRange("\n",{line:n.line,ch:0})):i.trimRight().length<=n.ch&&e.replaceRange(i.trimRight(),{line:n.line,ch:0},n)}})),o.on("change",((e,t)=>{this.tabs.current.isModified=!0})),e.editor=o}async closeTabs(e,t=!0){let n=this.tabs.current;for(const t of[...e])t===this.tabs.current&&(n=t.previousSibling??t.nextSibling),this.tabs.removeChild(t),this.views.removeChild(t.view);this.tabs.value=n?.value,0===this.tabs.childElementCount&&(this.mainArea.current=this.mainAreaEmpty),t&&await this.saveTabs()}async saveTabs(){this.projectSetting.tabs=[...u(this.tabs).map((e=>e.path))],this.projectSetting.currentTab=this.tabs.current?.path,await this.idbFile.putWorkSpaceSetting(this.projectSetting)}async restoreTabs(){for(const e of this.projectSetting.tabs)await this.openTab(e,!1);this.projectSetting.currentTab&&await this.openTab(this.projectSetting.currentTab)}async saveTab(...e){for(const t of e){if(!t.isModified)continue;const e=new Blob([t.editor.getValue()],{type:t.file.type});await this.idbFile.putFile(t.path,e),t.isModified=!1}}handleDragOver(e){e.preventDefault()}handleDrop(e){return e.preventDefault(),this.addFile(...u(e.dataTransfer.files).map((e=>({path:e.name,file:new Blob([e],{type:e.type})}))))}handleKeyDown(e){switch(e.keyCode){case 83:if(e.ctrlKey)return e.preventDefault(),this.saveTab(this.tabs.current);break;case 116:return e.preventDefault(),this.run()}}async handleSelectTemplate(e){const t=await(0,y.vf)(class extends y.Vq{titleTemplate(){return"テンプレート選択"}bodyTemplate(){return'\n          <ul class="select-template-choices">\n            <li><button onclick="this.resolve(1)">「index.html」のみ作成</button></li>\n            <li><button onclick="this.resolve(2)">「index.html」、「style.css」、「main.js」を作成</button></li>\n          </ul>\n        '}buttonsTemplate(){return'\n          <button onclick="return this.handleCancel(event)">キャンセル</button>\n        '}})();await this.createTemplateFiles(t)}async createTemplateFiles(e){switch(e){case 1:await this.addFile({path:"index.html",file:new Blob(['<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8">\n    <title>My App</title>\n  </head>\n  <body>\n    <p>Hello, World!</p>\n  </body>\n</html>\n'],{type:"text/html"})}),await this.openTab("index.html");break;case 2:await this.addFile({path:"index.html",file:new Blob(['<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8">\n    <title>My App</title>\n    <link rel="stylesheet" href="style.css">\n  </head>\n  <body>\n    <div id="container"></div>\n    <script src="main.js"><\/script>\n  </body>\n</html>\n'],{type:"text/html"})},{path:"style.css",file:new Blob(["#container {\n  font-size: 24px;\n}\n"],{type:"text/css"})},{path:"main.js",file:new Blob(["var container = document.getElementById('container');\ncontainer.innerHTML = 'Hello, World!';\n"],{type:"text/javascript"})}),await this.openTab("index.html",!1),await this.openTab("style.css",!1),await this.openTab("main.js")}}handleFileTreeKeyDown(e){switch(e.keyCode){case 13:return this.command("open");case 46:return this.command("delete");case 113:return this.command("rename")}}handleFileTreeDoubleClick(e){if(!e.target.classList.contains("expand-icon")&&this.fileTree.current&&!this.fileTree.current.isExpandable)return this.openTab(this.fileTree.getPath())}async handleFileTreeContextMenu(e){e.preventDefault();const t=await O(e);t&&await this.command(t)}async command(e){switch(e){case"newFile":case"newFolder":{let t=this.fileTree.current;t&&(t.isExpandable||(t=t.parentNode),t!==this.fileTree&&t.expand());const n="newFile"===e?"ファイル":"フォルダー";let i="";for(;;){if(i=await this.inputFileName(`${n}名`,i,`新規${n}`),!i)return;const t=this.idbFile.getFileType(i),r=this.fileTree.getFolderPath()+i,s="newFile"===e?{path:r,file:new Blob([""],{type:t})}:{path:r};try{return void await this.addFile(s)}catch(e){if("ConstraintError"!==e.name)throw e;await(0,y.Z9)("この場所には同名のファイルまたはフォルダーがあります","エラー")}}}case"rename":{const e=this.fileTree.current.text,t=this.fileTree.current.isExpandable,n=await this.inputFileName(t?"フォルダー名":"ファイル名",e,"名前の変更");if(!n)return;let i=this.fileTree.getPath(this.fileTree.current.parentNode);return""!==i&&(i+="/"),this.fileListMove(i+e,i+n)}case"delete":{const e=this.fileTree.current.isExpandable;if(!await(0,y.iG)((e?"フォルダー":"ファイル")+' "'+this.fileTree.current.text+'" を削除しますか?'))break;return this.deleteCurrentFileOrFolder()}case"open":if(!this.fileTree.current||this.fileTree.current.isExpandable)return;return this.openTab(this.fileTree.getPath());default:throw new Error("Undefiend command: "+e)}}async inputFileName(e,t,n){for(;;){const i=await(0,y.eB)(e+"を入力してください",t,n);if(!i)return"";let r="";if(u('\\/:*?"<>|').some((e=>i.includes(e)))?r=e+'には次の文字は使えません:\n\\ / : * ? " < > |':"."!==i&&".."!==i||(r="その"+e+"を付けることはできません"),!r)return i;await(0,y.Z9)(r,"注意"),t=i}}async fileListMove(e,t){if(e===t)return;if((t+"/").startsWith(e+"/"))return void await(0,y.Z9)("受け側のフォルダーは、送り側フォルダーのサブフォルダーです。","中断");if(await this.idbFile.getFile(t))return void await(0,y.Z9)("受け側のフォルダーに同名のファイルまたはフォルダーがあります。","中断");const n=await this.idbFile.moveFile(e,t);for(const[e,t]of n){const n=this.tabs.get(e);n&&(n.path=t),await this.saveTabs()}this.fileTree.move(e,t)}async handleFileTreeMouseDown(e){if(1===e.button)return;const t=u(function*(e){for(;e;)yield e,e=e.parentNode}(e.target)).map((e=>c.from(e))).find((e=>e instanceof _.Item));if(!t)return;let n=null;const i=[];let r=null;m({ondragstart:(e,r,s)=>{n=c.createElement('\n          <div style="position: absolute; text-align: center; opacity: .75;" class="flex column"></div>\n        '),n.appendChild(t.element.querySelector(".icon").cloneNode(!0)),n.appendChild(t.element.querySelector("span").cloneNode(!0)),s.appendChild(n),function e(t){for(const n of t){const t=n.element.firstElementChild;i.push({item:n,elem:t,rect:t.getBoundingClientRect()}),n.isExpandable&&n.isExpanded&&e(n)}}(this.fileTree),i.push({item:this.fileTree,elem:this.fileTree.element,rect:this.fileTree.element.getBoundingClientRect()}),i.push({item:null,elem:this.mainArea.element,rect:this.mainArea.element.getBoundingClientRect()}),this.fileTree.element.blur()},ondrag:(e,t)=>{n.style.top=t-n.clientWidth/2+"px",n.style.left=e-n.clientHeight/2+"px";const s=i.find((({rect:n})=>e>=n.left&&e<n.left+n.width&&t>=n.top&&t<n.top+n.height));s!==r&&(r&&r.elem.classList.remove("drop-target"),r=s,r&&r.elem.classList.add("drop-target"))},ondragend:(e,n)=>{if(r){if(r.elem.classList.remove("drop-target"),r.elem===this.mainArea.element){if(!this.fileTree.current||this.fileTree.current.isExpandable)return;return this.openTab(this.fileTree.getPath())}if(this.fileTree.focus(),r.item===t)return;const e=this.fileTree.getPath(t),n=this.fileTree.getFolderPath(r.item)+t.text;return this.fileListMove(e,n)}},onerror:e=>{this.onerror(e)}})}async handleTabChange(e){const t=this.tabs.current;if(t){if(this.views.value=t.path,document.title=t.path+" - "+this.name,!t.editor)return;requestAnimationFrame((()=>{t.editor.refresh(),t.editor.focus()}))}else document.title=this.name}async handleTabMouseDown(e){if("mousedown"===e.type&&0!==e.button)return;if(e.target.classList.contains("close-button"))return e.preventDefault(),void await this.closeTabs([c.from(e.target.parentElement)]);let t,n,i;const r=()=>{t=null,requestAnimationFrame((()=>{t=[...u(this.tabs).map(((e,t)=>({idx:t,tab:e,rect:e.element.getBoundingClientRect()})))],n=u(this.tabs).indexOf(this.tabs.current)}))};r(),m({ondrag:(e,s)=>{if(!t)return;const o=t.find((t=>e>=t.rect.left&&e<t.rect.right&&s>=t.rect.top&&s<t.rect.bottom));null!=o&&o!==this.tabs.current?i!==o.tab&&(i=o.tab,this.tabs.insertBefore(this.tabs.current,o.idx<n?o.tab:o.tab.nextSibling),r()):i=null},ondragend:()=>{this.saveTabs()},onerror:e=>{this.onerror(e)}})}handleDragSplitter(){this.tabs.current&&this.tabs.current.editor.refresh()}handleMenuMouseDown(e){if(0!==e.button)return;const t=D(this.menubar,e.target);return t&&"workspace"===t.dataset.key?this.showWorkSpaceList(e):void 0}async handleMenuClick(e){const t=D(this.menubar,e.target);if(!t)return;const n=t.dataset.key;if(null!=n)switch(n){case"workspace":return;case"newProject":if(!await(0,y.iG)("現在のプロジェクトを閉じますか?\n(保存していないデータは失われます)"))return;return this.newProject();case"loadProject":if(!await(0,y.iG)("現在のプロジェクトを閉じて、別のプロジェクトを開きますか?\n(保存していないデータは失われます)"))return;return this.loadProject();case"saveProject":return this.saveProject();case"run":return this.run(e);default:throw new Error("Undefiend command: "+n)}}async showWorkSpaceList(e){if(e.target.classList.contains("selected"))return;e.target.classList.add("selected");const t=await this.idbFile.getAllWorkSpaces(),n=await C(`\n      ${t.map(((e,t)=>`\n        <div data-value="${t}">\n          <i class="material-icons" style="font-size: 16px;">${e.path+"/"===this.idbFile.workspace?"check":"_"}</i>\n          <span>${e.label}</span>\n        </div>\n      `)).join("")}\n    `)(e.target),i=t[n];e.target.classList.remove("selected"),i&&this.idbFile.workspace!==i.path+"/"&&(await this.closeTabs(this.tabs,!1),this.projectSetting=i.setting,this.idbFile.workspace=i.path+"/",await this.refreshFileTree(),await this.restoreTabs())}async run(){await Promise.all(u(this.tabs).map((e=>this.saveTab(e)))),u(this.fileTree).every((e=>"index.html"!==e.text))?await(0,y.Z9)('"index.html" が無いため実行できません'):this.debugWindow&&!this.debugWindow.closed?(await this.debugWindow.fetch(this.base+"resources/blank.txt"),this.debugWindow.location.replace(this.base+"debug/"+this.idbFile.workspace)):(this.debugWindow=window.open(this.base+"resources/blank.txt","appWindow","width=400,height=400"),this.debugWindow.opener=null,this.debugWindow.onload=async function(){this.debugWindow.location.replace(this.base+"debug/"+this.idbFile.workspace)}.bind(this))}async fetchEZip(){return(await Promise.all([s.e(498),s.e(834)]).then(s.bind(s,4834))).default}async saveProject(){const e=new(await this.fetchEZip())(this.projectSetting);await e.save(async function(){return this.idbFile.getAllFiles()}.bind(this))&&await this.idbFile.putWorkSpaceSetting(this.projectSetting)}async newProject(e=!0){await this.closeTabs(this.tabs,!1),this.idbFile.removeAllFiles(),this.fileTree.textContent="",this.sideArea.current=this.sideAreaEmpty,e&&(this.projectSetting=this.idbFile.createDefaultSetting(),await this.idbFile.putWorkSpaceSetting(this.projectSetting))}async loadProject(){const e=new(await this.fetchEZip())(this.projectSetting),t=await e.load();t&&(await this.newProject(!1),await this.addFile(...t),await this.idbFile.putWorkSpaceSetting(this.projectSetting))}onerror(e){throw(0,y.Z9)(e.message,"エラー"),e}})})(),o=s.O(o)})();